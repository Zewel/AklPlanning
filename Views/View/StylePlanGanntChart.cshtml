

<div class="container-fluid">

    <div class="card card-primary">
        <div class="card-header">
            <div class="row">
                <h3 class="card-title"><span class="fa fa-search"></span> Style-Info Search Criteria</h3>
            </div>
        </div>
        <div class="card-body row">


            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fa fa-arrow-down"></i>
                            Style & Po Wise
                        </h3>
                    </div>
                    <!-- /.card-header -->
                    <div class="card-body">
                        <div class="form-group">
                            <label for="styleNo">Style No.</label>
                            <input type="text" class="form-control" id="styleNo" placeholder="Enter Style No.">
                        </div>
                        <div class="form-group">
                            <label for="poNo">Po. No.</label>
                            <input type="text" class="form-control" id="poNo" placeholder="Enter Po. No.">
                        </div>

                    </div>
                </div>
                <!-- /.card-body -->
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fa fa-arrow-down"></i>
                            Date Wise
                        </h3>
                    </div>
                    <!-- /.card-header -->
                    <div class="card-body">

                        <div class="form-group clearfix">
                            <div class="icheck-primary d-inline">
                                <input type="radio" id="radioPrimary1" onclick="RadioInput()" value="1" name="r1">
                                <label for="radioPrimary1">
                                    Order Conf. Date
                                </label>
                            </div>
                            <div class="icheck-primary d-inline">
                                <input type="radio" id="radioPrimary2" onclick="RadioInput()" value="2" name="r1">
                                <label for="radioPrimary2">
                                    Delivery Date
                                </label>
                            </div>
                        </div>
                        <fieldset class="border p-2" id="orderDiv">
                            <legend class="w-auto" style="font-size:12px;">Order Date:</legend>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="orderFromDate">From Date</label>
                                        <input type="date" class="form-control" id="orderFromDate" placeholder="Enter Date">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="orderToDate">To Date</label>
                                        <input type="date" data-date-format="DD MMMM YYYY" class="form-control" id="orderToDate" placeholder="Enter Date">
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset class="border p-2" id="deliveryDiv">
                            <legend class="w-auto" style="font-size:12px;">Delivery Date:</legend>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="orderFromDate">From Date</label>
                                        <input type="date" class="form-control" id="deliveryFromDate" placeholder="Enter Date">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="orderToDate">To Date</label>
                                        <input type="date" class="form-control" id="deliveryToDate" placeholder="Enter Date">
                                    </div>
                                </div>
                            </div>
                        </fieldset>

                    </div>

                    @*<fieldset class="border p-2">
                            <legend class="w-auto" style="font-size:12px;">Planning Date:</legend>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="orderFromDate">From Date</label>
                                        <input type="date" class="form-control" id="planningFromDate" placeholder="Enter Date">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="orderToDate">To Date</label>
                                        <input type="date" class="form-control" id="planningToDate" placeholder="Enter Date">
                                    </div>
                                </div>

                            </div>
                        </fieldset>*@

                </div>
            </div>
            <!-- /.card-body -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fa fa-arrow-down"></i>
                            Buyer & Merchant
                        </h3>
                    </div>
                    <!-- /.card-header -->
                    <div class="card-body">
                        <div class="form-group" id="divBuyer">
                            <label>Buyer</label>
                            <input type="text" class="form-control" id="buyer" placeholder="Enter Po. No.">
                        </div>
                        <div class="form-group" id="divMerchant">
                            <label>Merchantdiser</label>
                            <input type="text" class="form-control" id="marchent" placeholder="Enter Po. No.">
                        </div>
                        <div class="form-group" id="divTeam">
                            <label>Team Name</label>
                            <input type="text" class="form-control" id="teamHead" placeholder="Enter Po. No.">
                        </div>

                    </div>
                </div>
                <!-- /.card-body -->
            </div>

        </div>
        <div class="card-footer">
            <button type="submit" onclick="GetAllStyle()" id="processButton" class="float-right btn btn-primary">Submit</button>
        </div>
    </div>
    <div class="row" id="StyleListView">

    </div>

</div>
<div class="col-md-12 col-xs-12 text-center" id="testSpan" style="display: none">

    <span>
        Please wait Data is loading -
        <img src="~/assets/img/dataTableLoader.gif" />
        @*<img src="~/assets/img/loading-2.gif" />*@
    </span>

</div>
@section Scripts{
    <script>
        $(function () {
            $('#orderDiv').hide();
            $('#deliveryDiv').hide();

            $("#styleNo").autocomplete({

                source: function (request, response) {
                    $.ajax({
                        url: apiHeader + "api/Common/GetStlNo/" + request.term,
                        dataType: "json",
                        success: function (data) {
                            var stl = [];
                            $.each(data, function (i, item) {
                                stl.push(item.StlDesc);
                            });
                            response(stl);

                        }
                    });
                },
                minLength: 3,
                //select: function (event, ui) {
                //    log(ui.item ?
                //        "Selected: " + ui.item.label :
                //        "Nothing selected, input was " + this.value);
                //},
                //open: function () {
                //    $(this).removeClass("ui-corner-all").addClass("ui-corner-top");
                //},
                //close: function () {
                //    $(this).removeClass("ui-corner-top").addClass("ui-corner-all");
                //}
            });


        });
        function ExcelList(){
            debugger;
            //let table = document.getElementsByTagName("table");
            //console.log(table);
            //debugger;
            //TableToExcel.convert(table[0], {
            //    name: `UserManagement.xlsx`,
            //    sheet: {
            //        name: 'Usermanagement'
            //    }
            //});
            var table2excel = new Table2Excel();

            table2excel.export(document.querySelectorAll('table'));
        }
        function GetAllStyle() {
            var PoNo = $('#poNo').val();
            var StyleNo = $('#styleNo').val();
            var Buyer = $('#buyer').val();
            var Marchant = $('#marchent').val();
            var TeamHead = $('#teamHead').val();
            var OrderFromDate = $('#orderFromDate').val();
            var OrderToDate = $('#orderToDate').val();
            var DeliveryFromDate = $('#deliveryFromDate').val();
            var DeliveryToDate = $('#deliveryToDate').val();
            var entity = {
                PoNo: PoNo,
                StyleNo: StyleNo,
                Buyer: Buyer,
                Marchant: Marchant,
                TeamHead: TeamHead,
                OrderFromDate: OrderFromDate,
                OrderToDate: OrderToDate,
                DeliveryFromDate: DeliveryFromDate,
                DeliveryToDate: DeliveryToDate
            };
            debugger;
             var urlpath = '@Url.Action("PlanGanntChart", "PartialView")';


             $.ajax({
                type: "POST",
                 url: urlpath,
                contentType: "application/json;charset=utf-8",
                 data: JSON.stringify(entity),
                 dataType: "html",
                 beforeSend: function () {
                     $('#testSpan').show();
                     $("#StyleListView").empty();
                 },
                success: function (result) {

                    $("#StyleListView").html(result);
                    $('#testSpan').hide();

                },

                complete: function () {
                   // window.location.href = '@Url.Action("CreateSlot", "View")';

                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }

        function RadioInput() {
            debugger;
            var inputValue = parseInt($('input[name="r1"]:checked').val());
            if (inputValue == 1) {
                $('#orderDiv').show();
                $('#deliveryDiv').hide();
                $('#deliveryFromDate').val("");
                $('#deliveryToDate').val("");
            } else {
                $('#orderFromDate').val("");
                $('#orderToDate').val("");
                $('#orderDiv').hide();
                $('#deliveryDiv').show();
            }
        }
        function ExportAllData_HTML() {
            var wb = { SheetNames: [], Sheets: {} };
            var ws9 = XLSX.utils.table_to_sheet(document.getElementById('exportStylelList'), { raw: true });
            wb.SheetNames.push('Temp Table'); wb.Sheets["Temp Table"] = ws9;
            XLSX.writeFile(wb, "AllStyleList.xlsx", { cellStyles: true });
        }


        //function ExportAllData_HTML() {
        //    var wb = { SheetNames: [], Sheets: {} };
        //    var ws9 = XLSX.utils.table_to_sheet(document.getElementById('exportStylelList'), { raw: true });
        //    wb.SheetNames.push('Temp Table'); wb.Sheets["Temp Table"] = ws9;
        //    XLSX.writeFile(wb, "myTemp.xlsx", { cellStyles: true });
        //}
        function Print(element) {

            window.open(reportHeader+"Report/CapacityReport?stlCode=" + element, '_blank');
        }

        //function tableToExcel() {

        //    var table = "exportStylelList";
        //    var sheetName = "Blank";
        //    var fileName = "AllStyleInfo";
        //    var ua = window.navigator.userAgent;
        //    var msie = ua.indexOf("MSIE ");
        //    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
        //    {
        //        return fnExcelReport(table, fileName);
        //    }

        //    var uri = 'data:application/vnd.ms-excel;base64,',
        //        templateData = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>',
        //        base64Conversion = function (s) { return window.btoa(unescape(encodeURIComponent(s))) },
        //        formatExcelData = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }

        //    $("tbody > tr[data-level='0']").show();

        //    if (!table.nodeType)
        //        table = document.getElementById(table)

        //    var ctx = { worksheet: sheetName || 'Worksheet', table: table.innerHTML }

        //    var element = document.createElement('a');
        //    element.setAttribute('href', 'data:application/vnd.ms-excel;base64,' + base64Conversion(formatExcelData(templateData, ctx)));
        //    element.setAttribute('download', fileName);
        //    element.style.display = 'none';
        //    document.body.appendChild(element);
        //    element.click();
        //    document.body.removeChild(element);

        //    $("tbody > tr[data-level='0']").hide();
        //}

        //function fnExcelReport(table, fileName) {

        //    var tab_text = "<table border='2px'>";
        //    var textRange;

        //    if (!table.nodeType)
        //        table = document.getElementById(table)

        //    $("tbody > tr[data-level='0']").show();
        //    tab_text = tab_text + table.innerHTML;

        //    tab_text = tab_text + "</table>";
        //    tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
        //    tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
        //    tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

        //    txtArea1.document.open("txt/html", "replace");
        //    txtArea1.document.write(tab_text);
        //    txtArea1.document.close();
        //    txtArea1.focus();
        //    sa = txtArea1.document.execCommand("SaveAs", false, fileName + ".xls");
        //    $("tbody > tr[data-level='0']").hide();
        //    return (sa);
        //}



    </script>
}
